<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/global.css">
    <script src="/js/custom-nav.js" type="text/javascript" defer></script>
    <title>Spring AOP</title>
  </head>
  <body>
    <custom-nav href="/study/study.html"></custom-nav>
    <div class="mx-4 mt-4 text-center"><h1>🪡Spring AOP</h1></div>
    <p class="text-center mb-0" style="font-size: small;">iconcert8's log</p>
    <p class="text-center text-secondary" style="font-size: x-small;">2023-03-15</p>
    <div class="m-4 d-flex justify-content-center">
        <div class="d-inline-block limit-width">
            <h2>AOP(Aspect Oriented Programming)</h2>
            <p>
                AOP는 관점에 중심을 둔다는 의미이다. 
                여기서 관점이란 기능과 서비스를 원하는 지점에서 실행시키는 것이며 단어 그대로 '보는 지점'을 말한다.
                <br><br>
                함수에 로그 기능을 추가하고 싶으면 코드 앞뒤로 로그 코드를 삽입하게 된다.
                생각해보면 이는 로그라는 기능과 기존 코드 기능 2가지 서비스를 담고 있는 것이다.
                기존 코드의 수정을 야기할 뿐더러 OCP(Open-Closed Principle)와 SRP(Single Responsibility Principle) 규칙에 맞지 않는 확장이다.
                <br><br>
                디자인 패턴에서는 기능을 추가 확장 시키고 싶을 때 데코레이터 패턴을 사용한다.
                그리고 AOP에서는 데코레이터 패턴과 유사하지만 의미적으로 간접 호출(접근 제어)을 의미하는 <strong>프록시 패턴</strong>을 사용하여 관점 지향을 달성한다.
                <br><br>
                컴파일 or 런 타임 때 기존 클래스의 프록시 클래스를 만든다. 
                프록시 클래스에는 확장 기능(eg. 로그)과 기존 함수 호출코드가 병합이 된다.
                동적으로 프록시 객체를 만들어 사용하기 때문에 기존 코드 수정 없이 기능이 확장된다.
            </p>
            <h2>용어</h2>
            <p class="ps-2">
                <strong>Advice</strong>
                추가하고자 하는 함수, 로직
                <br>
                <strong>JointPoint</strong>
                기존 함수
                <br>
                <strong>PointCut</strong>
                기존 함수 중에 적용하고자 하는 함수만 필터링
                <br>
                <strong>Weaving</strong>
                JointPoint를 Advice로 감싸는 과정, Proxy 객체 생성.
            </p>
            <h2>Weaving</h2>
            <p class="ps-2">
                <strong>Run-time weaving</strong>
                <br>
                <span class="text-secondary" style="font-size: small;">
                    Spring AOP에서 사용하는 방식이다. Run-time에 프록시 객체를 생성한다.
                    CGLIB Proxy 혹은 Dynamic Proxy를 생성한다. 비교적 느린편이다.
                </span>
                <br><br>
                <strong>Load-time weaving</strong>
                <br>
                <span class="text-secondary" style="font-size: small;">
                    AspectJ 라이브러리를 추가해서 사용가능하다.
                    객체를 Load 할 때 프록시 객체가 만들어 진다.
                    오직 
                </span>
                <br><br>
                <strong>Compile-time weaving</strong>
                <br>
                <span class="text-secondary" style="font-size: small;">
                    AspectJ 라이브러리를 추가해서 사용가능하다.
                    Compile 시에 weaving을 통해 클래스를 생성하는 방식이다.
                    가장 성능이 좋은 방식이다. 단, Lombok과 같은 Complie 시점 라이브러리와 충돌 가능성이 있다.
                </span>
            </p>
            <h2>Proxy tool</h2>
            <p class="ps-2">
              <strong>Dynamic Proxy</strong>
              <br>
              <span class="text-secondary" style="font-size: small;">
                인터페이스 기반으로 Proxy를 생성한다. 상위 인터페이스가 없으면 Proxy 생서을 못한다.
              </span>
              <br><br>
              <strong>CGLIB(Code Generator Library)</strong>
              <br>
              <span class="text-secondary" style="font-size: small;">
                클래스를 상속하여 Proxy를 생성한다.
                바이트 코드를 조작하여 proxy를 생성한다.
                현재 Spring에서 CGLIB을 사용한다.
              </span>

            </p>
        </div>
      </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
  </body>
</html>
